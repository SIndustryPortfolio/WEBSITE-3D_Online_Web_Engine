<!DOCTYPE html>

<html lang="en">

<head>
    <title>{{ core.name }}</title>
    <meta charset="UTF-8">

    <!-- EXTERNAL -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> <!-- BOOTSTRAP : DESIGN + LAYOUT -->
    
    <!-- SCRIPTS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script> <!-- BOOTSTRAP : DESIGN + LAYOUT -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script> <!-- JQUERY : AJAX SUPPORT -->
     
    <!-- INTERNAL -->
    <link href="{{ url_for('static', filename='css/main.css') }}" rel="stylesheet"> <!-- MAIN : CONSISTENT DESIGN -->
</head>
<body>
    
    <meta name="csrf-token" content="{{ csrf_token() }}">

    <div hidden id="hiddenDump"></div>

    <!-- LOG OUT POP UP MODAL -->
    <div class = "modal fade" id="logoutModal" tabindex="-1" style="display: none;">
        <div class = "modal-dialog">
            <div class = "modal-content bg-dark">
                <div class = "modal-body">
                    <h4 class = "modal-title text-light">Logout</h4>
                    <hr class="border-top border-secondary opacity-50 my-2">

                    <p class="text-secondary">Are you sure you want to log out?</p>

                    <hr class="border-top border-secondary opacity-50 my-2">
                            
                    <div class="row" style="justify-content: flex-end;">
                        <button class="btn btn-secondary" data-bs-dismiss="modal" style="display: inline-block; width: 20%; margin: 0 2% 0 2%">Cancel</button>

                        <!-- LOG OUT OPTION -->
                        <form action="/logout" method="post" style="display: inline-block; width: 20%; margin: 0 2% 0 2%">
                            <input id="csrf_token" name="csrf_token" type="hidden" value="{{ csrf_token() }}">
                            <input type="submit" class="btn btn-danger" value="Logout"/>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <nav class="navbar navbar-expand-sm bg-dark navbar-dark shadow-sm">
        <div class="container-fluid">

            <!-- NAV BAR ITEMS ON LEFT -->
            <ul class="navbar-nav mr-auto">
                <li class="navbar-brand" style="align-items: center; display: flex; white-space: nowrap; width: 15%; height: 80%">
                    <a href="/"><img src="{{url_for('static', filename='images/Logo.png')}}" class="card-title img-fluid" alt="Home"></a>
                </li>
                
                {% for pageKey, pageInfo in pages.items() %}
                    
                    {% if "topBar" in pageInfo %}
                        {% if pageInfo.topBar.side == "left" %}
                            {% if not pageInfo.topBar.userAuthorisedOnly or (pageInfo.topBar.userAuthorisedOnly and user) %}
                                <li class="nav-item" style="align-items: center; display: flex;">
                                    <a class="nav-link
                                    {% if currentPage == pageInfo.name %}
                                        active
                                    {% endif %}
                                    " href="{{ pageInfo.redirectLink }}">{{ pageInfo.topBar.displayName }}</a>
                                </li>
                            {% endif %}
                        {% endif %}
                    {% endif %}

                {% endfor %}
            </ul>

            <!-- NAV BAR ITEMS ON RIGHT -->
            <ul class="navbar-nav ml-auto">
                <li class="nav-item ms-auto ml-auto" style="align-items: center; display: flex; float: right;">
                    {% for pageKey, pageInfo in pages.items() %}
                        {% if "topBar" in pageInfo %}
                            {% if pageInfo.topBar.side ==  "right" %}
                                {% if not pageInfo.topBar.userAuthorisedOnly or (pageInfo.topBar.userAuthorisedOnly and user) %}
                                    <li class="nav-item" style="align-items: center; display: flex;">
                                        <a class="nav-link
                                        {% if currentPage == pageInfo.name %}
                                            active
                                        {% endif %}
                                        " href="{{ pageInfo.redirectLink }}">{{ pageInfo.topBar.displayName }}</a>
                                    </li>
                                {% endif %}
                            {% endif %}
                        {% endif %}
                    {% endfor %}

                    {% if user %}
                        <a class="nav-link" data-bs-toggle="modal" data-bs-target="#logoutModal">Logout</a>

                    {% else %}
                         <a class="nav-link
                         
                         {% if currentPage == 'Login' %}
                            active
                         {% endif %}
                         
                         " href="/login">Login</a>
                    {% endif %}
                </li>
            </ul>
        </div>
    </nav>

    <!-- ALERT -->
    {% include "handlers/alertHandler.html" %}

     <!-- AJAX -->
    {% include "handlers/ajaxResponseHandler.html" %}

</body>

</html>